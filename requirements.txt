# IMPORTANT: To prevent heavy NVIDIA CUDA/CuDNN packages from being installed:
#
# Recommended approach (ensures CPU-only PyTorch):
#   1. pip install --no-cache-dir --index-url https://download.pytorch.org/whl/cpu torch torchvision
#   2. pip install --no-cache-dir -r requirements.txt
#
# Alternative: The --extra-index-url below will make pip prefer CPU PyTorch wheels,
# but installing torch separately first is more reliable.

# FastAPI and ASGI server
fastapi>=0.104.0
uvicorn[standard]>=0.24.0
python-multipart>=0.0.6

# Pydantic for data validation
pydantic>=2.5.0
pydantic-settings>=2.1.0

# Celery for async task processing
celery>=5.3.0
redis>=5.0.0

# HTTP client (for webhook callbacks)
httpx>=0.25.0

# Twilio for WhatsApp
twilio>=8.10.0

# Security
python-jose[cryptography]>=3.3.0
passlib[bcrypt]>=1.7.4

# Database
sqlalchemy>=2.0.0
alembic>=1.12.0
pymysql>=1.1.0  # MySQL connector

# Utilities
python-dotenv>=1.0.0

# Logging
structlog>=23.2.0

# RAG Dependencies
# LLM
google-generativeai>=0.3.0  # Gemini API
groq>=0.4.0  # Groq API for text enhancement

# PyTorch CPU-only (must be installed before sentence-transformers to avoid CUDA dependencies)
# Install from CPU-only wheel to prevent CUDA packages
# Note: Install both torch and torchvision together from CPU index for compatibility
--extra-index-url https://download.pytorch.org/whl/cpu
torch>=2.0.0,<3.0.0
torchvision>=0.15.0,<1.0.0  # Required by timm and Deepdoctection, must match torch version

# Embeddings (will use CPU torch from above)
sentence-transformers>=2.2.0
numpy>=1.24.0,<2.0.0

# Vector Store
faiss-cpu>=1.7.4

# Document Processing
# Note: pypdf is included as dependency of langchain-community
python-docx>=1.1.0
beautifulsoup4>=4.12.0
pandas>=2.0.0
openpyxl>=3.1.0

# LangChain - only install what's needed (text splitters and document loaders)
# langchain-community pulls in transformers, so we force CPU torch above
langchain-text-splitters>=0.0.1
langchain-community>=0.0.20

# OCR
pytesseract>=0.3.10
Pillow>=10.0.0

# Deepdoctection dependencies
# Note: Install torch and torchvision CPU-only first: 
#       pip install --no-cache-dir --index-url https://download.pytorch.org/whl/cpu torch torchvision
# Then install these Deepdoctection packages
opencv-python-headless>=4.8.0  # OpenCV for Deepdoctection (headless version to save space, no GUI dependencies)
timm>=0.9.16  # PyTorch Image Models for Deepdoctection
transformers>=4.48.0  # HuggingFace Transformers for Deepdoctection
python-doctr>=1.0.0  # Document Text Recognition (docTR) for OCR
deepdoctection>=1.0.0  # Document AI server/inference core package

